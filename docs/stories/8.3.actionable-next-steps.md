# Story 8.3: Actionable Next Steps & Priority Recommendations

## Status

**Draft**

## Story

**As a** user,
**I want** concrete next steps and priority recommendations,
**so that** I know exactly which labs to contact and when.

## Acceptance Criteria

1. "Next Steps" section added to Overview.md (FR27)
2. Top 3-5 priority labs identified based on fitness + position availability
3. Recommended contact timing provided (e.g., "Contact soon - PhD graduating in 6 months")
4. Contact methods listed for each priority lab (email, contact form link)
5. Application cycle considerations mentioned if relevant
6. Personalized recommendations based on user's profile
7. Action items formatted as checklist

## Tasks / Subtasks

- [ ] **Task 1: Identify Priority Labs** (AC: 2)
  - [ ] Select top 3-5 labs
  - [ ] Consider fitness + position availability

- [ ] **Task 2: Generate Contact Recommendations** (AC: 3, 4)
  - [ ] Suggest contact timing
  - [ ] List contact methods

- [ ] **Task 3: Create Action Items** (AC: 1, 7)
  - [ ] Format as checklist
  - [ ] Add to Overview.md

## Dev Notes

### Source Tree Location
- Modify: `src/agents/report_generator.py`
- Modify: `output/Overview.md` (created in Story 8.1)

### Dependencies
- **Story 8.1 must complete first** - This story adds "Next Steps" section to Overview.md
- Requires user profile data from Epic 1 (consolidated research profile)

### Input Data
- Ranked labs from: `checkpoints/phase-7-fitness-scores.jsonl`
- User profile from: `config/user-profile.json` or consolidated profile document
- Contact information from Lab objects (Epic 4 data)

### Priority Lab Selection Algorithm
Select top 3-5 labs where:
```python
priority_labs = [
    lab for lab in ranked_labs
    if lab.fitness_score >= 75
    AND (lab.has_graduating_phd OR lab.recently_departed_phd OR lab.fitness_score >= 85)
][:5]  # Take top 5 maximum
```
- **Threshold 1:** Fitness score must be ≥75 (high-quality match)
- **Threshold 2:** Either position signal detected OR exceptional fit (≥85)
- **Result:** Top 3-5 labs that are both good fits AND likely have opportunities

### Contact Timing Recommendations
Determine timing based on:
- **"Contact soon"** - PhD graduating within 6 months OR recent departure (<3 months)
- **"Contact before [season]"** - PhD graduating in 6-12 months, align with application cycles
- **"Standard timeline"** - No position signals but high fitness score
- **Application cycle context:** Typical grad school deadlines (December-January for Fall admission)

### Personalization Strategy
Customize recommendations using user profile data:
- **Target semester:** From user config (Fall 2025, Spring 2026, etc.)
- **Research interests:** Highlight alignment specific to user's stated interests
- **Current degree:** Tailor messaging (current undergrad vs. current MS student)
- **Timeline urgency:** Adjust contact timing based on user's desired start date

### Action Items Format
Generate as markdown checklist:
```markdown
## Next Steps

### Priority Labs to Contact

1. **[ ] Dr. Smith - Bioengineering** (Fitness: 92)
   - **Why:** Strong ML research alignment, PhD graduating May 2025
   - **When:** Contact soon (graduating PhD creates opening)
   - **How:** Email: smith@university.edu | [Lab Contact Form](url)
   - **Talking Points:** Your neural network experience aligns with their BCI work

2. **[ ] Dr. Jones - Computer Science** (Fitness: 88)
   ...
```

## Testing

### Testing Approach
- **Unit Tests:** Priority selection algorithm, timing recommendation logic, personalization functions
- **Integration Tests:** Action items generation with real user profile and lab data

### Key Test Scenarios
1. **Happy Path:** 5 priority labs with position signals, verify correct selection and timing recommendations
2. **Edge Case - No Priority Labs:** All labs have fitness <75, verify graceful handling with "consider reaching out to top labs" message
3. **Edge Case - All High Fitness, No Position Signals:** Labs with scores ≥85 included even without LinkedIn data
4. **Edge Case - Missing Contact Info:** Handle labs without email/contact form gracefully
5. **Validation:** Verify personalization uses correct user profile fields
6. **Validation:** Contact timing aligns with PhD graduation dates from Epic 6

### Success Criteria
- Priority selection algorithm correctly filters labs
- 3-5 priority labs identified (or fewer if insufficient candidates)
- Contact timing recommendations accurate based on LinkedIn data
- Personalized talking points reference user's research interests
- All contact methods validated and functional
- Checklist format renders correctly in markdown

## References

### Related Documentation
- **PRD:** Epic 8 Actionable Next Steps (docs/prd.md:834-847)
- **PRD:** User Profile Consolidation (docs/prd.md:290-303) - Epic 1
- **Architecture:** Report Generator component (docs/architecture.md:1307-1319)

### Dependencies
- **Story 8.1:** Overview.md creation (must complete first)
- **Epic 1:** User Profile Consolidation (provides personalization data)
- **Epic 7:** Fitness scoring (provides ranked labs with scores)
- **Epic 6:** LinkedIn Integration (provides PhD graduation/departure data)
- **Epic 4:** Lab Intelligence (provides contact information)

### Data Sources
- User profile: Output from Epic 1 (consolidated research profile document)
- Fitness scores: `checkpoints/phase-7-fitness-scores.jsonl`
- Contact methods: Lab object's `contact_info` field
- Position signals: Lab object's `graduating_phds` and `recent_departures` fields

### Key Fields from User Profile
- `target_start_semester`: When user wants to start (e.g., "Fall 2025")
- `research_interests`: User's research focus areas
- `current_degree`: Current academic status
- `background_highlights`: Key qualifications to mention in talking points

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-06 | 0.1 | Initial story creation | Sarah (PO) |
