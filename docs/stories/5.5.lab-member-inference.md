# Story 5.5: Lab Member Inference from Co-Authorship

## Status

**Draft**

## Story

**As a** user,
**I want** lab members inferred from publication co-authorship when websites are missing or stale,
**so that** I still get comprehensive lab intelligence.

## Acceptance Criteria

1. When lab website unavailable or severely outdated, use publications (FR31)
2. Frequent co-authors on PI's papers identified as likely lab members
3. Co-authorship patterns analyzed (repeated collaboration over time)
4. Institutional affiliations checked to confirm same university
5. Inferred members flagged as "inferred from publications" in reports (FR32)
6. Confidence levels assigned to inferences
7. Inferred member list used for Story 5.4 publication discovery

## Tasks / Subtasks

- [ ] **Task 1: Identify Labs with Missing Member Data** (AC: 1)
  - [ ] Check if Lab.members is empty
  - [ ] Check if website stale (from Story 4.4)
  - [ ] Flag for member inference

- [ ] **Task 2: Extract Co-Authors from PI Publications** (AC: 2)
  - [ ] Get all PI publications
  - [ ] Extract co-author names
  - [ ] Count co-authorship frequency

- [ ] **Task 3: Analyze Co-Authorship Patterns** (AC: 3)
  - [ ] Identify frequent collaborators (>= 2 papers)
  - [ ] Check temporal patterns (across multiple years)

- [ ] **Task 4: Verify University Affiliation** (AC: 4)
  - [ ] Check author affiliations in papers
  - [ ] Confirm same university as PI

- [ ] **Task 5: Create Inferred Member Records** (AC: 5, 6)
  - [ ] Create LabMember model instances
  - [ ] Flag: `data_quality_flags: ["inferred_from_coauthorship"]`
  - [ ] Assign confidence based on frequency

- [ ] **Task 6: Update Lab Model** (AC: 7)
  - [ ] Add inferred members to Lab.members
  - [ ] Use for publication retrieval in Story 5.4

## Dev Notes

### Source Tree Location
- Modify: `src/agents/publication_retrieval.py`
- Create: `src/models/lab_member.py`

**Inference Logic:**
```python
def infer_lab_members(pi_pubs: list[Publication]) -> list[LabMember]:
    coauthor_freq = Counter()
    for pub in pi_pubs:
        for author in pub.authors:
            if author != pi_name:
                coauthor_freq[author] += 1

    # Threshold: >= 2 papers
    likely_members = [name for name, count in coauthor_freq.items() if count >= 2]
    return [LabMember(name=name, inferred=True, confidence=min(count*20, 100))
            for name in likely_members]
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-06 | 0.1 | Initial story creation | Sarah (PO) |
